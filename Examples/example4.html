<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>JQen Loop Example</title>
</head>

<body>
    <div id="container"></div>
    <script src="JQen.js" defer></script>
    <script>
        const template = `
<loop set="object" value="item">
    <div>{var:item[var1]} {var:item[var2]} {var:item[var3]} {var:item[var4]}</div>
</loop>
<br />
<loop set="array" value="item">
    <div>{var:item[0]} {var:item[1]} {var:item[2]} {var:item[3]}</div>
</loop>
`;

        const data = `
{
    "object": [
        {
            "var1": "value1",
            "var2": "value2",
            "var3": "value3",
            "var4": "value4"
        },
        {
            "var1": "value5",
            "var2": "value6",
            "var3": "value7",
            "var4": "value8"
        }
    ],
    "array": [
        [
            "value10",
            "value20",
            "value30",
            "value40"
        ],
        [
            "value100",
            "value200",
            "value300",
            "value400"
        ]
    ]
}`;

        const JQenRender = (() => {
            let instance = null;

            return async (template, data, name = "") => {
                if (!instance) {
                    instance = JQenModule().then((Module) => {
                        Module.Render = Module.cwrap("JQen_Render", "string", ["string", "string", "string"]);
                        return Module;
                    });
                }

                return (await instance).Render(template, data, name);
            };
        })();

        document.addEventListener("DOMContentLoaded", async () => {
            document.getElementById("container").innerHTML = await JQenRender(template, data, "Loop Example");
        });
    </script>
</body>

</html>
